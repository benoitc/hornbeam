<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.39.1">
    <meta name="project" content="hornbeam v1.0.0">


    <title>erlang-integration — hornbeam v1.0.0</title>

    <link rel="stylesheet" href="dist/html-erlang-7YNYEB7F.css" />

    <script defer src="dist/sidebar_items-DCB24D7B.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-HBZYRXZS.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="https://hornbeam.dev" class="sidebar-projectName" translate="no">
hornbeam
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of hornbeam</span>
            <div class="search-input-wrapper">
              <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
              <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
                <i class="ri-close-line ri-lg" title="Cancel search"></i>
              </button>
            </div>
          </label>
        </form>
        <div class="autocomplete">
        </div>
        <div class="engine-selector" data-multiple="false">
          <button type="button" class="engine-button" aria-label="Select search engine" aria-haspopup="true" aria-expanded="false">
            <i class="ri-search-2-line" aria-hidden="true"></i>
            <span class="engine-name">Default</span>
            <i class="ri-arrow-down-s-line" aria-hidden="true"></i>
          </button>
          <div class="engine-dropdown" hidden role="menu">

              <button type="button"
                      class="engine-option"
                      data-engine-url="search.html?q="
                      role="menuitemradio"
                      aria-checked="true">
                <span class="name">Default</span>
                <span class="help">In-browser search</span>
              </button>

          </div>
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>erlang-integration</h1>


      <a href="https://github.com/benoitc/hornbeam/blob/v1.0.0/docs/guides/erlang-integration.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<hr class="thin"/><p>title: Erlang Integration
description: Using ETS, RPC, Pub/Sub, and callbacks from Python
order: 13</p><hr class="thin"/><h1>Erlang Integration</h1><p>Hornbeam's power comes from accessing Erlang features directly from Python. This guide covers shared state (ETS), distributed RPC, pub/sub messaging, and registered functions.</p><h2 id="shared-state-ets" class="section-heading"><a href="#shared-state-ets" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Shared State (ETS)</span></h2><p>ETS (Erlang Term Storage) provides high-performance concurrent key-value storage accessible from Python.</p><h3 id="basic-operations" class="section-heading"><a href="#basic-operations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Basic Operations</span></h3><pre><code class="python">from hornbeam_erlang import (
    state_get, state_set, state_delete,
    state_incr, state_decr,
    state_get_multi, state_keys
)

# Get and set values
state_set('user:123', {'name': 'Alice', 'email': 'alice@example.com'})
user = state_get('user:123')  # Returns dict or None

# Delete
state_delete('user:123')</code></pre><h3 id="atomic-counters" class="section-heading"><a href="#atomic-counters" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Atomic Counters</span></h3><p>Perfect for metrics, rate limiting, and sequences:</p><pre><code class="python"># Increment (returns new value)
views = state_incr('page_views')           # +1
views = state_incr('page_views', 10)       # +10

# Decrement
remaining = state_decr('quota', 1)

# Use for rate limiting
def check_rate_limit(user_id, limit=100):
    key = f'rate:{user_id}:{minute()}'
    count = state_incr(key)
    if count == 1:
        state_set(f'{key}:ttl', 60)  # Set TTL on first access
    return count &lt;= limit</code></pre><h3 id="batch-operations" class="section-heading"><a href="#batch-operations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Batch Operations</span></h3><pre><code class="python"># Get multiple keys at once
users = state_get_multi(['user:1', 'user:2', 'user:3'])
# Returns: {'user:1': {...}, 'user:2': {...}, 'user:3': None}

# Find keys by prefix
user_keys = state_keys('user:')
# Returns: ['user:1', 'user:2', 'user:123', ...]</code></pre><h3 id="use-cases" class="section-heading"><a href="#use-cases" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Use Cases</span></h3><p><strong>Caching:</strong></p><pre><code class="python">def get_product(product_id):
    cached = state_get(f'product:{product_id}')
    if cached:
        return cached

    product = fetch_from_database(product_id)
    state_set(f'product:{product_id}', product)
    return product</code></pre><p><strong>Session Storage:</strong></p><pre><code class="python">def get_session(session_id):
    return state_get(f'session:{session_id}')

def set_session(session_id, data):
    state_set(f'session:{session_id}', data)</code></pre><p><strong>Real-time Metrics:</strong></p><pre><code class="python">def track_request(path, status, latency):
    state_incr(f'metrics:requests:{path}')
    state_incr(f'metrics:status:{status}')
    # Update latency histogram
    bucket = latency // 100 * 100  # Round to 100ms buckets
    state_incr(f'metrics:latency:{bucket}')</code></pre><h2 id="distributed-rpc" class="section-heading"><a href="#distributed-rpc" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Distributed RPC</span></h2><p>Call functions on remote Erlang nodes in a cluster:</p><pre><code class="python">from hornbeam_erlang import rpc_call, rpc_cast, nodes, node

# Get cluster info
current = node()           # This node's name
connected = nodes()        # List of connected nodes

# Synchronous call
result = rpc_call(
    'worker@gpu-server',   # Remote node
    'ml_model',            # Module
    'predict',             # Function
    [input_data],          # Arguments
    timeout_ms=30000       # Timeout
)

# Async call (fire and forget)
rpc_cast('logger@log-server', 'logger', 'log', [
    'info', 'User logged in', {'user_id': 123}
])</code></pre><h3 id="distributed-ml-inference" class="section-heading"><a href="#distributed-ml-inference" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Distributed ML Inference</span></h3><p>Spread ML workloads across GPU nodes:</p><pre><code class="python">from hornbeam_erlang import rpc_call, nodes
import asyncio

async def distributed_embedding(texts):
    &quot;&quot;&quot;Distribute embedding computation across GPU nodes.&quot;&quot;&quot;
    gpu_nodes = [n for n in nodes() if 'gpu' in n]

    if not gpu_nodes:
        # Fallback to local
        return local_embed(texts)

    # Split work across nodes
    chunks = split_list(texts, len(gpu_nodes))
    results = []

    for node, chunk in zip(gpu_nodes, chunks):
        result = rpc_call(
            node,
            'embedding_service',
            'encode',
            [chunk],
            timeout_ms=60000
        )
        results.extend(result)

    return results</code></pre><h3 id="error-handling" class="section-heading"><a href="#error-handling" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Error Handling</span></h3><pre><code class="python">from hornbeam_erlang import rpc_call

try:
    result = rpc_call('worker@remote', 'mod', 'func', [args])
except TimeoutError:
    # Node didn't respond in time
    result = fallback()
except ConnectionError:
    # Node not connected
    result = fallback()
except Exception as e:
    # Remote function raised an error
    log_error(f&quot;RPC failed: {e}&quot;)
    result = fallback()</code></pre><h2 id="pub-sub-messaging" class="section-heading"><a href="#pub-sub-messaging" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Pub/Sub Messaging</span></h2><p>pg-based publish/subscribe for real-time messaging:</p><pre><code class="python">from hornbeam_erlang import publish, subscribe, unsubscribe

# Subscribe current process to topic
subscribe('notifications')
subscribe('user:123:events')

# Publish message (returns subscriber count)
count = publish('notifications', {
    'type': 'alert',
    'message': 'Server restart in 5 minutes'
})

# Unsubscribe
unsubscribe('notifications')</code></pre><h3 id="websocket-with-pub-sub" class="section-heading"><a href="#websocket-with-pub-sub" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">WebSocket with Pub/Sub</span></h3><pre><code class="python">from hornbeam_erlang import publish, subscribe, receive_pubsub

async def websocket_handler(scope, receive, send):
    await send({'type': 'websocket.accept'})

    user_id = get_user_from_scope(scope)
    subscribe(f'user:{user_id}')

    try:
        while True:
            # Check for client messages
            message = await receive()
            if message['type'] == 'websocket.disconnect':
                break

            # Check for pub/sub messages
            pubsub_msg = receive_pubsub(timeout=0)
            if pubsub_msg:
                await send({
                    'type': 'websocket.send',
                    'text': json.dumps(pubsub_msg)
                })
    finally:
        unsubscribe(f'user:{user_id}')</code></pre><h3 id="broadcasting-updates" class="section-heading"><a href="#broadcasting-updates" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Broadcasting Updates</span></h3><pre><code class="python">def update_product(product_id, data):
    # Update in ETS
    state_set(f'product:{product_id}', data)

    # Notify all subscribers
    publish(f'product:{product_id}', {
        'type': 'updated',
        'product_id': product_id,
        'data': data
    })</code></pre><h2 id="registered-functions" class="section-heading"><a href="#registered-functions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Registered Functions</span></h2><p>Call Erlang functions from Python:</p><h3 id="register-in-erlang" class="section-heading"><a href="#register-in-erlang" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Register in Erlang</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Register a simple function</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">register_function</span><span class="p" data-group-id="1158238546-1">(</span><span class="ss">add</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="1158238546-2">(</span><span class="p" data-group-id="1158238546-3">[</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p" data-group-id="1158238546-3">]</span><span class="p" data-group-id="1158238546-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="1158238546-1">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Register a module function</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">register_function</span><span class="p" data-group-id="1158238546-4">(</span><span class="ss">get_user</span><span class="p">,</span><span class="w"> </span><span class="ss">user_db</span><span class="p">,</span><span class="w"> </span><span class="nb">get</span><span class="p" data-group-id="1158238546-4">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Register with validation</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">register_function</span><span class="p" data-group-id="1158238546-5">(</span><span class="ss">validate_token</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="1158238546-6">(</span><span class="p" data-group-id="1158238546-7">[</span><span class="n">Token</span><span class="p" data-group-id="1158238546-7">]</span><span class="p" data-group-id="1158238546-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">auth</span><span class="p">:</span><span class="nf">verify</span><span class="p" data-group-id="1158238546-8">(</span><span class="n">Token</span><span class="p" data-group-id="1158238546-8">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="1158238546-9">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p" data-group-id="1158238546-9">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="1158238546-10">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p" data-group-id="1158238546-10">}</span><span class="p">;</span><span class="w">
        </span><span class="ss">error</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="1158238546-11">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">invalid_token</span><span class="p" data-group-id="1158238546-11">}</span><span class="w">
    </span><span class="k">end</span><span class="w">
</span><span class="k">end</span><span class="p" data-group-id="1158238546-5">)</span><span class="p">.</span></code></pre><h3 id="call-from-python" class="section-heading"><a href="#call-from-python" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Call from Python</span></h3><pre><code class="python">from hornbeam_erlang import call, cast

# Synchronous call
result = call('add', 1, 2)  # Returns 3

# Get user from Erlang
user = call('get_user', user_id)

# Validate token
try:
    user_id = call('validate_token', token)
except Exception as e:
    return {'error': 'Invalid token'}

# Async call (fire and forget)
cast('log_event', 'user_login', {'user_id': 123})</code></pre><h3 id="use-cases-1" class="section-heading"><a href="#use-cases-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Use Cases</span></h3><p><strong>Authentication:</strong></p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Erlang side</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">register_function</span><span class="p" data-group-id="3526221664-1">(</span><span class="ss">verify_session</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="3526221664-2">(</span><span class="p" data-group-id="3526221664-3">[</span><span class="n">SessionId</span><span class="p" data-group-id="3526221664-3">]</span><span class="p" data-group-id="3526221664-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">session_store</span><span class="p">:</span><span class="nf">get</span><span class="p" data-group-id="3526221664-4">(</span><span class="n">SessionId</span><span class="p" data-group-id="3526221664-4">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="3526221664-5">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Session</span><span class="p" data-group-id="3526221664-5">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3526221664-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Session</span><span class="p" data-group-id="3526221664-6">}</span><span class="p">;</span><span class="w">
        </span><span class="ss">not_found</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3526221664-7">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">not_found</span><span class="p" data-group-id="3526221664-7">}</span><span class="w">
    </span><span class="k">end</span><span class="w">
</span><span class="k">end</span><span class="p" data-group-id="3526221664-1">)</span><span class="p">.</span></code></pre><pre><code class="python"># Python side
def get_current_user(request):
    session_id = request.cookies.get('session_id')
    if not session_id:
        return None

    try:
        session = call('verify_session', session_id)
        return session.get('user')
    except:
        return None</code></pre><p><strong>Feature Flags:</strong></p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Erlang side</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">register_function</span><span class="p" data-group-id="6447281592-1">(</span><span class="ss">feature_enabled</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="6447281592-2">(</span><span class="p" data-group-id="6447281592-3">[</span><span class="n">Feature</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p" data-group-id="6447281592-3">]</span><span class="p" data-group-id="6447281592-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">feature_flags</span><span class="p">:</span><span class="nf">is_enabled</span><span class="p" data-group-id="6447281592-4">(</span><span class="n">Feature</span><span class="p">,</span><span class="w"> </span><span class="n">UserId</span><span class="p" data-group-id="6447281592-4">)</span><span class="w">
</span><span class="k">end</span><span class="p" data-group-id="6447281592-1">)</span><span class="p">.</span></code></pre><pre><code class="python"># Python side
def get_features(user_id):
    return {
        'new_ui': call('feature_enabled', 'new_ui', user_id),
        'beta': call('feature_enabled', 'beta', user_id),
    }</code></pre><h2 id="hooks" class="section-heading"><a href="#hooks" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Hooks</span></h2><p>Execute Erlang code at key points in request lifecycle:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Configure hooks</span><span class="w">
</span><span class="nc">hornbeam</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="3165797800-1">(</span><span class="s">&quot;app:application&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3165797800-2">#{</span><span class="w">
    </span><span class="ss">hooks</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="3165797800-3">#{</span><span class="w">
        </span><span class="ss">on_request</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="3165797800-4">(</span><span class="n">Request</span><span class="p" data-group-id="3165797800-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Log, authenticate, modify request</span><span class="w">
            </span><span class="n">Request</span><span class="w">
        </span><span class="k">end</span><span class="p">,</span><span class="w">
        </span><span class="ss">on_response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="3165797800-5">(</span><span class="n">Response</span><span class="p" data-group-id="3165797800-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Modify response, log metrics</span><span class="w">
            </span><span class="n">Response</span><span class="w">
        </span><span class="k">end</span><span class="p">,</span><span class="w">
        </span><span class="ss">on_error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="3165797800-6">(</span><span class="n">Error</span><span class="p">,</span><span class="w"> </span><span class="n">Request</span><span class="p" data-group-id="3165797800-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Error handling, alerting</span><span class="w">
            </span><span class="nc">error_logger</span><span class="p">:</span><span class="nf">error_msg</span><span class="p" data-group-id="3165797800-7">(</span><span class="s">&quot;Error: </span><span class="si">~p</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3165797800-8">[</span><span class="n">Error</span><span class="p" data-group-id="3165797800-8">]</span><span class="p" data-group-id="3165797800-7">)</span><span class="p">,</span><span class="w">
            </span><span class="p" data-group-id="3165797800-9">{</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Internal Error&quot;</span><span class="p" data-group-id="3165797800-9">}</span><span class="w">
        </span><span class="k">end</span><span class="w">
    </span><span class="p" data-group-id="3165797800-3">}</span><span class="w">
</span><span class="p" data-group-id="3165797800-2">}</span><span class="p" data-group-id="3165797800-1">)</span><span class="p">.</span></code></pre><h2 id="best-practices" class="section-heading"><a href="#best-practices" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Best Practices</span></h2><h3 id="1-use-ets-for-hot-data" class="section-heading"><a href="#1-use-ets-for-hot-data" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">1. Use ETS for Hot Data</span></h3><pre><code class="python"># Good: Frequently accessed, changes often
state_set('rate_limit:user:123', count)
state_set('session:abc123', session_data)

# Bad: Large, rarely accessed (use database)
state_set('user:history', huge_list)</code></pre><h3 id="2-atomic-operations" class="section-heading"><a href="#2-atomic-operations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">2. Atomic Operations</span></h3><pre><code class="python"># Good: Atomic increment
count = state_incr('counter')

# Bad: Race condition
count = state_get('counter') or 0
state_set('counter', count + 1)</code></pre><h3 id="3-key-naming-convention" class="section-heading"><a href="#3-key-naming-convention" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">3. Key Naming Convention</span></h3><pre><code class="python"># Use structured keys
state_set('user:123:profile', profile)
state_set('cache:product:456', product)
state_set('metric:requests:total', count)</code></pre><h3 id="4-handle-missing-keys" class="section-heading"><a href="#4-handle-missing-keys" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">4. Handle Missing Keys</span></h3><pre><code class="python"># state_get returns None for missing keys
value = state_get('maybe_exists')
if value is None:
    value = compute_default()
    state_set('maybe_exists', value)</code></pre><h2 id="next-steps" class="section-heading"><a href="#next-steps" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Next Steps</span></h2><ul><li><a href="./ml-integration">ML Integration</a> - Caching ML inference</li><li><a href="../examples/distributed-ml">Distributed ML Example</a> - Cluster inference</li><li><a href="../reference/erlang-api">Erlang API Reference</a> - All Erlang modules</li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="websocket.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
websocket
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="ml-integration.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
ml-integration
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/hornbeam/1.0.0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/hornbeam/1.0.0">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/hornbeam/1.0.0/show/docs/guides/erlang-integration.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="hornbeam.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.39.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
